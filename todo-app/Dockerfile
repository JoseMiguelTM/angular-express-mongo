# UNIR 2010G TEAM - DOCKERFILE FOR FRONT APP
# USE NODE V18 ALPINE FROM DOCKER HUB
FROM node:18-alpine AS build

# SET WORKDIR TO /app FOLDER
WORKDIR /app

# COPY ALL FILES FROM ROOT (./todo-app)
COPY . .

# RUN DEPENDENCIES INSTALLATION WITH npm install
RUN npm install

# RUN APP BUILD PROCESS
RUN npm run build

# NGINX PROCESS
# USE NGINX ALPINE FROM DOCKER HUB
FROM nginx:alpine

# COPY ALL GENERATED FILES FROM BUILD PROCESS, THEN COPY TO NGINX FOLDER
COPY --from=build /app/dist/todo-app/ /usr/share/nginx/html

# COPY NGINX CONFIGURATION FILE FROM FILES TO CONTAINER
COPY ./nginx/nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80